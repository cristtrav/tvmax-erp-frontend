<div class="inner-component">
    <div class="main-breadcrumb">
        <nz-breadcrumb>
            <nz-breadcrumb-item>
                <a routerLink="/welcome"><i nz-icon nzType="home"></i></a>
            </nz-breadcrumb-item>
            <nz-breadcrumb-item>
                Clientes
            </nz-breadcrumb-item>
        </nz-breadcrumb>
    </div>
    <div class="module-container">
        <div class="module-content">
            <a nz-button nzType="primary" routerLink="/clientes/nuevo">
                <i nz-icon nzType="plus"></i>
                Nuevo
            </a>
            <ng-template #pietabla>
                <nz-space>
                    <nz-space-item>
                        <strong>Total:</strong>
                    </nz-space-item>
                    <nz-space-item>{{ total | number}}</nz-space-item>
                </nz-space>
            </ng-template>
            <nz-table #tbl [nzData]="lstClientes" style="margin-top: 10px;" nzShowSizeChanger
                [nzFrontPagination]="false" [nzTotal]="total" [nzPageSize]="pageSize" [nzPageIndex]="pageIndex"
                [nzLoading]="tablaLoading" (nzQueryParams)="onTableParamsChange($event)" [nzFooter]="pietabla">
                <thead>
                    <tr>
                        <th></th>
                        <th>Código</th>
                        <th>Razón social</th>
                        <th>CI/RUC</th>
                        <th>Domicilio princ.</th>
                        <th>Suscripciones</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngFor="let c of tbl.data">
                        <tr>
                            <td [nzExpand]="expandSet.has(c.id===null?-1:c.id)"
                                (nzExpandChange)="onRowExpand(c.id===null?-1:c.id, $event)"></td>
                            <td>{{ c.id }}</td>
                            <td>{{ c.razonsocial }}</td>
                            <td>
                                <span *ngIf="c.ci">
                                    {{ c.ci | number }}
                                    <span *ngIf="c.ci!==null && c.dvruc!=null">-</span>
                                {{c.dvruc}}
                                </span>
                                <span *ngIf="!c.ci" style="color: gray">(Sin CI/RUC)</span>
                            </td>
                            <td nzBreakWord>
                                <a nz-tooltip nzTooltipTitle="Ver todos los domicilios" [routerLink]="c.id+'/domicilios'">
                                    <i nz-icon nzType="eye"></i>
                                </a>
                                <nz-divider nzType="vertical"></nz-divider>
                                <span *ngIf="c.direccion">
                                    {{ c.direccion }}
                                    ({{ c.barrio }})
                                </span>
                                <span *ngIf="!c.direccion" style="color: gray">
                                    (Sin domicilio principal)
                                </span>
                            </td>
                            <td>
                                <a nz-tooltip nzTooltipTitle="Ver todas las suscripciones" [routerLink]="c.id+'/suscripciones'">
                                    <i nz-icon nzType="eye"></i>
                                </a>
                                <nz-divider nzType="vertical"></nz-divider>
                                <nz-tag [nzColor]="'#00C853'">{{ c.cantconectados }} Con.</nz-tag>
                                <nz-tag [nzColor]="'#f44336'">{{ c.cantdesconectados }} Des.</nz-tag>
                            </td>
                            <td>
                                <a [routerLink]="'/clientes/'+c.id">Editar</a>
                                <nz-divider nzType="vertical"></nz-divider>
                                <a nz-popconfirm nzPopconfirmTitle="¿Desea eliminr el Cliente?"
                                    nzPopconfirmPlacement="bottom" nzOkText="Eliminar" (nzOnConfirm)="eliminar(c.id)">
                                    Eliminar
                                </a>
                            </td>
                        </tr>
                        <tr [nzExpand]="expandSet.has(c.id===null?-1:c.id)">
                            <span>
                                <nz-space nzSize="large">
                                    <nz-space-item>
                                        <strong>Email: </strong>
                                        <span [style]="!c.email?'color: gray':''">{{ c.email?c.email:'(sin email)' }}</span>
                                    </nz-space-item>
                                    <nz-space-item>
                                        <strong>Teléfono princ.: </strong>
                                        <span [style]="!c.telefono1?'color: gray':''">{{ c.telefono1?c.telefono1:'(sin teléfono)' }}</span>
                                    </nz-space-item>
                                    <nz-space-item>
                                        <strong>Teléfono sec.:</strong>
                                        <span [style]="!c.telefono2?'color: gray':''"> {{ c.telefono2?c.telefono2:'(sin teléfono)' }}</span>
                                    </nz-space-item>
                                    <nz-space-item>
                                        <strong>Cobrador: </strong>
                                        <span>{{ c.cobrador }} ({{ c.idcobrador }})</span>
                                    </nz-space-item>
                                </nz-space>
                            </span>
                        </tr>
                    </ng-container>
                </tbody>
            </nz-table>
        </div>
    </div>
</div>