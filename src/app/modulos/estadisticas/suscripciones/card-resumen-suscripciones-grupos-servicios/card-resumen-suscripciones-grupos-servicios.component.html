<nz-card [nzTitle]="titulo" [nzExtra]="extraTitulo">
    <ng-template #titulo>
        <span nz-typography nzType="secondary" style="font-size: smaller;">Grupos y Servicios</span>
    </ng-template>
    <ng-template #extraTitulo>
        <button nz-button nzType="default" (click)="cargarDatos()">
            <i nz-icon nzType="reload" nzTheme="outline"></i>
        </button>
    </ng-template>

    <nz-table #expandTable
        [nzData]="listOfMapData"
        [nzShowSizeChanger]="false"
        [nzShowPagination]="false"
        [nzLoading]="loadingDatos"
        nzSize="small">
        <thead>
          <tr>
            <th>Grupo / servicio</th>
            <th>No. suscripciones</th>
            <th>Deuda total</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let data of expandTable.data">
            <ng-container *ngFor="let item of mapOfExpandedData[data.key]">
              <tr *ngIf="(item.parent && item.parent.expand) || !item.parent">
                <td
                  [nzIndentSize]="item.level! * 20"
                  [nzShowExpand]="!!item.children"
                  [(nzExpand)]="item.expand"
                  (nzExpandChange)="collapse(mapOfExpandedData[data.key], item, $event)"
                >
                  <span *ngIf="item.idreferencia" nz-tooltip [nzTooltipTitle]="'Código: '+item.idreferencia">{{ item.referencia }}</span>
                  <span *ngIf="!item.idreferencia">{{ item.referencia }}</span>
                </td>
                <td>{{ item.cantidad }} {{ item.cantidad == 1 ? 'sucripción' : 'suscripciones'}}</td>
                <td nzAlign="right">Gs.{{ item.monto | number }}</td>
              </tr>
            </ng-container>
          </ng-container>
        </tbody>
      </nz-table>
</nz-card>
